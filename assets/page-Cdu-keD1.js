import{a as o,j as i,o as U,b as W,C as S,c as _,u as Q}from"./index-Bpll8QAE.js";import{g as L,b as G,u as f}from"./units-CKh7G0uS.js";import{c as F,g as x,b as j,a as A,d as $}from"./openWeather-CsIbjIca.js";/* empty css              */function B(t,a){if(!t)return[];const e=[],l=t.main.temp,n=t.main.feels_like,r=t.main.humidity,c=t.wind.speed,u=t.weather[0].main.toLowerCase(),d=a==="imperial"?(l-32)*(5/9):l,w=a==="imperial"?(n-32)*(5/9):n,s=a==="imperial"?c*1.60934:c*3.6;return u.includes("thunderstorm")&&e.push("Stay indoors if possible — thunderstorms can be dangerous. Avoid open areas and tall objects. "),u.includes("snow")&&e.push("Dress in layers and wear waterproof boots — snowy conditions can make roads slippery. "),(u.includes("rain")||u.includes("drizzle"))&&e.push("Carry a light waterproof jacket — rain showers can pop up suddenly. "),(u.includes("fog")||u.includes("mist"))&&e.push("Drive carefully with low beam lights — visibility is reduced in foggy conditions. "),d<-10?e.push("Extremely cold weather — wear multiple layers, gloves, and a warm hat to protect from frostbite. "):d<0?e.push("Freezing temperatures — bundle up with a warm coat and watch for icy sidewalks. "):d<10&&e.push("Chilly weather — a jacket or sweater is recommended, especially in the morning and evening. "),d>30?e.push("Very hot day — stay hydrated, wear light clothing, and avoid prolonged sun exposure. "):d>25&&e.push("Warm weather — sunscreen and sunglasses are recommended if you'll be outside for a while. "),e.length<3&&Math.abs(d-w)>5&&(n<l?e.push("Wind chill makes it feel colder — dress warmer than the temperature suggests. "):e.push("High humidity makes it feel warmer — it may feel warmer than the actual temperature. ")),e.length<3&&r>80&&e.push("High humidity today — expect muggy conditions and consider indoor activities. "),e.length<3&&s>40?e.push("Very windy conditions — secure loose objects and be careful when walking outside. "):e.length<3&&s>25&&e.push("Moderate winds expected — hold onto your hat and be careful with umbrellas. "),e.length<3&&u.includes("clear")&&(d>=15&&d<=25?e.push("Perfect weather for outdoor activities — enjoy the beautiful clear skies! "):e.push("Clear skies today — great visibility for sightseeing and outdoor plans. ")),e.length<3&&u.includes("clouds")&&e.push("Cloudy conditions — no need for sunglasses, but check back for weather changes. "),e.length===0&&e.push("Pleasant weather conditions — dress comfortably and enjoy your day! "),e.slice(0,3)}function z(t){switch(t){case 1:return"Good";case 2:return"Fair";case 3:return"Moderate";case 4:return"Poor";case 5:return"Very Poor";default:return"Unknown"}}function H({temperature:t,realFeel:a,iconUrl:e}){const n=L()==="imperial"?"°F":"°C";return o("div",{className:"temperature-info",children:[i("div",{className:"weather-icon-large",children:i("img",{src:e,alt:"Weather icon",className:"weather-icon-img"})}),o("div",{className:"temperature-display",children:[o("span",{className:"temperature-value",children:[t,n]}),o("span",{className:"real-feel",children:["RealFeel: ",a,n]})]})]})}function V({wind:t,humidity:a,airQuality:e,windUnit:l}){return o("div",{className:"weather-info",children:[o("div",{className:"info-item",children:[i("span",{className:"info-label",children:"Wind:"}),o("span",{className:"info-value",children:[t," ",l]})]}),o("div",{className:"info-item",children:[i("span",{className:"info-label",children:"Humidity:"}),o("span",{className:"info-value",children:[a,"%"]})]}),o("div",{className:"info-item",children:[i("span",{className:"info-label",children:"Air Quality:"}),i("span",{className:`info-value ${(r=>r==="Good"?"quality-good":r==="Moderate"?"quality-moderate":"quality-poor")(e)}`,children:e||"Loading..."})]})]})}function Y({tip:t}){return t?i("div",{className:"tip-row",children:o("div",{className:"tip-content",children:[i("h3",{className:"tip-title",children:"Small Tip:"}),i("p",{className:"tip-text",children:t})]})}):null}function K({onDetailsClick:t,onMapClick:a}){return o("div",{className:"modal-row",children:[i("button",{className:"tab-button",onClick:t,children:"Details"}),i("button",{className:"tab-button",onClick:a,children:"Map"})]})}const h={WIND:{id:"wind",name:"Wind",icon:"wind",unit:!0},AIR_QUALITY:{id:"air_quality",name:"Air Quality",icon:"lungs",unit:!1},HUMIDITY:{id:"humidity",name:"Humidity",icon:"humidity",unit:!0},TREE_POLLEN:{id:"tree_pollen",name:"Tree Pollen",icon:"tree",unit:!1},MOLD:{id:"mold",name:"Mold",icon:"mask",unit:!1},RUNNING:{id:"running",name:"Running",icon:"shoe",unit:!1},DRIVING:{id:"driving",name:"Driving",icon:"car",unit:!1},CYCLING:{id:"cycling",name:"Cycling",icon:"bicycle",unit:!1},FISHING:{id:"fishing",name:"Fishing",icon:"fishing",unit:!1},GOLF:{id:"golf",name:"Golf",icon:"golf",unit:!1}},Z=[h.WIND,h.AIR_QUALITY,h.HUMIDITY,h.TREE_POLLEN,h.MOLD,h.RUNNING,h.DRIVING,h.CYCLING,h.FISHING,h.GOLF],C=(t,a,e,l)=>{switch(t){case"wind":return a<3?"Good":a<7?"Moderate":"Bad";case"air_quality":return l?l===1||l===2?"Good":l===3?"Moderate":"Bad":"Moderate";case"humidity":return e<40||e>70?"Bad":e<50||e>60?"Moderate":"Good";case"running":case"cycling":{const c=((a<5?1:a<10?2:3)+(l||2))/2;return c<=1.5?"Good":c<=2.5?"Moderate":"Bad"}case"driving":return a<7?"Good":a<12?"Moderate":"Bad";case"fishing":return a>7||e>80?"Bad":a>4||e>65?"Moderate":"Good";case"golf":return a<3&&e<70?"Good":a<7&&e<80?"Moderate":"Bad";default:return"Moderate"}},J=(t,a,e)=>{const l=L();switch(t.id){case"wind":{const n=Math.round(a.wind.speed*3.6),r=G(l);return{value:`${n}${r}`,quality:C("wind",a.wind.speed,0,null)}}case"air_quality":{const n=C("air_quality",0,0,e);return{value:e?n:"N/A",quality:n}}case"humidity":return{value:`${a.main.humidity}%`,quality:C("humidity",0,a.main.humidity,null)};case"tree_pollen":case"mold":return{value:"Low",quality:"Low"};case"running":case"cycling":case"driving":case"fishing":case"golf":{const n=C(t.id,a.wind.speed,a.main.humidity,e);return{value:n,quality:n}}default:return{value:"N/A",quality:"Moderate"}}};function P({isOpen:t,title:a,onClose:e,children:l}){if(U(()=>{t&&(document.body.style.overflow="hidden")}),W(()=>{document.body.style.overflow=""}),!t)return null;function n(r){r.target.classList.contains("modal-backdrop")&&e()}return i("div",{className:"modal-backdrop",onClick:n,children:o("div",{className:"modal-container",children:[o("div",{className:"modal-header",children:[i(S,{onClick:e}),i("h2",{className:"modal-title",children:a}),i("div",{className:"modal-header-spacer"})]}),i("div",{className:"modal-content",children:l})]})})}function X({icon:t,name:a,value:e,quality:l}){const n="/bromiumjs-website/",r=c=>c==="Good"||c==="Low"?"quality-good":c==="Moderate"?"quality-moderate":"quality-bad";return o("div",{className:"activity-row",children:[i("div",{className:"activity-icon",children:i("img",{src:`${n}icons/activities/${t}.svg`,alt:a})}),o("div",{className:"activity-content",children:[o("span",{className:"activity-name",children:[a,":"]}),i("span",{className:`activity-value ${r(l)}`,children:e})]})]})}function ee({isOpen:t,onClose:a,weatherData:e,aqi:l}){return i(P,{isOpen:t,title:"Activities",onClose:a,children:i("div",{className:"activities-grid",children:Z.map(n=>{const r=J(n,e,l);return i(X,{icon:n.icon,name:n.name,value:r.value,quality:r.quality},n.id)})})})}const p={CLOUDS:{id:"clouds",name:"Clouds"},TEMPERATURE:{id:"temp",name:"Temperature"},PRECIPITATION:{id:"precipitation_new",name:"Thunderstorm"},WINDSPEED:{id:"wind_new",name:"Wind Speed"}},D=[{id:p.CLOUDS.id,name:p.CLOUDS.name},{id:p.TEMPERATURE.id,name:p.TEMPERATURE.name},{id:p.PRECIPITATION.id,name:p.PRECIPITATION.name},{id:p.WINDSPEED.id,name:p.WINDSPEED.name}],ae=(t,a,e)=>`https://{s}.basemaps.cartocdn.com/dark_all/${t}/${a}/${e}.png`,te=(t,a,e,l)=>{const n=t.map(a,{center:[e,l],zoom:10,zoomControl:!0});return t.tileLayer(ae("{z}","{x}","{y}"),{maxZoom:19}).addTo(n),n},R=(t,a,e)=>t.tileLayer(F(e,"{z}","{x}","{y}"),{opacity:.7}).addTo(a),ne=async()=>{if(!window.L){const t=document.createElement("link");t.rel="stylesheet",t.href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css",document.head.appendChild(t);const a=document.createElement("script");a.src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",await new Promise(e=>{a.onload=e,document.head.appendChild(a)})}};let m=null,g=null;function ie({isOpen:t,onClose:a,lat:e,lon:l}){const n=f(p.CLOUDS.id),r=f(!1),c=async s=>{s&&(m&&(m.remove(),m=null,g=null),await ne(),m=te(window.L,s,e,l),g=R(window.L,m,n.value),setTimeout(()=>{m&&m.invalidateSize()},100))},u=()=>{m&&(m.remove(),m=null,g=null)};W(()=>{u()}),t&&!m&&setTimeout(()=>{const s=document.getElementById("map-container");s&&c(s).then()},300);const d=s=>{n.value=s,r.value=!1,m&&(g&&m.removeLayer(g),g=R(window.L,m,s))};return i(P,{isOpen:t,onClose:a,title:"Map",children:i("div",{className:"map-modal-content",children:i("div",{id:"map-container",className:"map-container",children:o("div",{className:"map-layer-control",children:[i("button",{className:"layer-control-button",onClick:()=>r.value=!r.value,children:i("span",{className:"layer-name",children:D.find(s=>s.id===n.value)?.name||p.CLOUDS.name})}),r.value&&i("div",{className:"layer-control-menu",children:D.map(s=>i("button",{className:`layer-control-option ${n.value===s.id?"active":""}`,onClick:()=>d(s.id),children:s.name},s.id))})]})})})})}function ce(){const t=_(),a=Q(),e=f(null),l=f(null),n=f(!0),r=f(null),c=f(!1),u=f(!1),d=f({lat:0,lon:0}),w=f(null),s=L();async function q(){const I=t.value.query.city,T=t.value.query.timestamp;if(!I){await a.push("/");return}n.value=!0,r.value=null;try{let y,N,b;if(T){const v=await j(I);if(!v){r.value="Failed to fetch forecast data";return}const E=v.list.find(O=>O.dt===parseInt(T));if(!E){r.value="Weather data not found";return}y={...E,name:v.city.name,coord:{lat:0,lon:0},sys:{country:v.city.country,sunrise:0,sunset:0}};const M=await A(I);M?(N=M.coord.lat,b=M.coord.lon):(N=0,b=0)}else{if(y=await A(I),!y){r.value="Failed to fetch weather data";return}N=y.coord.lat,b=y.coord.lon}e.value=y,d.value={lat:N,lon:b},w.value=B(y,s);const k=await $(N,b);if(k){const v=k.list[0]?.main.aqi||0;l.value={aqi:v,text:z(v)}}}catch{r.value="Something went wrong"}finally{n.value=!1}}return U(()=>{q()}),n.value?i("div",{className:"weather-container",children:"Loading..."}):r.value||!e.value?i("div",{className:"weather-container",children:r.value||"No data available"}):o("div",{className:"weather-container",children:[o("div",{className:"weather-top-row",children:[i(H,{temperature:Math.round(e.value.main.temp),realFeel:Math.round(e.value.main.feels_like),iconUrl:x(e.value.weather[0].icon)}),i(V,{wind:Math.round(e.value.wind.speed*3.6),windUnit:G(s),humidity:e.value.main.humidity,airQuality:l.value?.text||"N/A"})]}),i(Y,{tip:w.value||[]}),i(K,{onDetailsClick:()=>c.value=!0,onMapClick:()=>u.value=!0}),i(ee,{isOpen:c.value,onClose:()=>c.value=!1,weatherData:e.value,aqi:l.value?.aqi||null}),i(ie,{isOpen:u.value,onClose:()=>u.value=!1,lat:d.value.lat,lon:d.value.lon,city:t.value.query.city})]})}export{ce as default};
