import{j as t,a as m,o as b,b as I,u as M}from"./index-BsMCQAo3.js";import{f as C,u as h}from"./units-DP1s0Rro.js";import{A as x,a as U}from"./ArrowRightIcon-BgFgw12o.js";import{g as W,a as E}from"./openWeather-BMJcz_u2.js";import{g as S,s as P,a as L,d as T}from"./locations-DoL-FnwZ.js";function $({size:n=24}){return t("img",{src:"/bromiumjs-website/icons/ui/magnifying-glass.svg",width:n,height:n,alt:"Search"})}function k({value:n,onChange:s,onSearch:c,disabled:r=!1}){function o(l){l.preventDefault(),r||c()}function i(l){const d=l.target;s(d.value)}return m("form",{className:"search-bar",onSubmit:o,children:[t("input",{type:"text",className:"search-input",placeholder:"Write a city here",value:n,onInput:i,disabled:r}),t("button",{className:"search-button",disabled:r,onClick:o,children:t($,{size:20})})]})}function z({size:n=24}){return t("img",{src:"/bromiumjs-website/icons/ui/bin.svg",width:n,height:n,alt:"Delete"})}function R({onClick:n}){return t("button",{onClick:n,children:t(z,{size:22})})}function j({city:n,country:s,temperature:c,icon:r,units:o,lastSearched:i,onSelect:l,onDelete:d}){function f(u){if(!u)return"";const v=new Date(u),w=new Date().getTime()-v.getTime(),g=Math.floor(w/6e4),p=Math.floor(w/36e5),e=Math.floor(w/864e5);return g<60?g===0?"Just now":`${g}m ago`:p<24?`${p}h ago`:e<7?`${e}d ago`:v.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"2-digit"})}function a(u){u.stopPropagation(),d()}return m("div",{className:"location-card",children:[m("div",{className:"location-info",onClick:l,children:[m("div",{className:"location-header",children:[t("h3",{className:"location-city",children:n}),t(R,{onClick:a})]}),t("p",{className:"location-country",children:s}),i&&t("p",{className:"location-time",children:f(i)})]}),m("div",{className:"location-weather",onClick:l,children:[t("div",{className:"weather-icon",children:r}),t("span",{className:"weather-temperature",children:C(Math.round(c),o)})]})]})}function q({locations:n,onSelect:s,onDelete:c}){const r=h(0),o=h(3),i=h(24),l=h(!1),d=h(!0),f=()=>{window.innerWidth<=768?o.value=2:o.value=3},a=()=>{i.value=window.innerWidth<=540?12:24},u=()=>{const e=document.querySelector(".locations-row");e&&(l.value=e.scrollLeft>0,d.value=e.scrollLeft<e.scrollWidth-e.clientWidth-10)},v=()=>{u()};b(()=>{f(),a(),window.addEventListener("resize",f),window.addEventListener("resize",a);const e=document.querySelector(".locations-row");e&&(e.addEventListener("scroll",v),setTimeout(u,100))}),I(()=>{window.removeEventListener("resize",f),window.removeEventListener("resize",a);const e=document.querySelector(".locations-row");e&&e.removeEventListener("scroll",v)});const y=e=>{const N=document.querySelector(".locations-row");if(!N)return;const D=e*220;N.scrollTo({left:D,behavior:"smooth"}),r.value=e},w=()=>y(Math.max(0,r.value-1)),g=()=>{const e=Math.max(0,n.length-o.value);y(Math.min(e,r.value+1))};if(!n?.length)return null;setTimeout(u,50);const p=n.length>o.value;return t("div",{className:"last-locations-section",children:m("div",{className:"locations-carousel",children:[p&&t("button",{className:"carousel-arrow carousel-arrow-left",onClick:w,disabled:!l.value,children:t(x,{width:i.value,height:i.value})}),t("div",{className:"locations-row",onScroll:v,children:n.map(e=>t(j,{city:e.city,country:e.country,temperature:e.temperature,lastSearched:e.lastSearched,units:e.savedUnits,icon:e.weatherData?.weather?.[0]?.icon?t("img",{src:W(e.weatherData.weather[0].icon),alt:"Weather"}):null,onSelect:()=>s(e),onDelete:()=>c(e.id)},e.id))}),p&&t("button",{className:"carousel-arrow carousel-arrow-right",onClick:g,disabled:!d.value,children:t(U,{width:i.value,height:i.value})})]})})}function J(){const n=M(),s=h(""),c=h([]),r=h(!1),o=h("");b(()=>{S()&&(c.value=L())});async function i(){if(!s.value.trim()){o.value="Please enter a city name";return}r.value=!0,o.value="";try{const a=await E(s.value);if(!a){o.value="City not found. Please try again.",r.value=!1;return}const u={id:Date.now(),city:a.name,country:a.sys.country,temperature:Math.round(a.main.temp),weatherData:a};S()&&(P(u),c.value=L()),await n.push(`/weather?city=${encodeURIComponent(a.name)}`)}catch(a){console.error("Error fetching weather:",a),o.value="Something went wrong. Please try again."}finally{r.value=!1}}function l(a){n.push(`/weather?city=${encodeURIComponent(a.city)}`)}function d(a){T(a),c.value=L()}const f=()=>S()&&c.value.length>0;return m("div",{className:"home-container",children:[m("div",{className:"search-section",children:[t("h1",{className:"search-title",children:"Search a city for weather..."}),t(k,{value:s.value,onChange:a=>s.value=a,onSearch:i,disabled:r.value}),o.value&&t("p",{className:"error-message",children:o.value}),r.value&&t("p",{className:"loading-message",children:"Searching..."})]}),f()&&t(q,{locations:c.value,onSelect:l,onDelete:d})]})}export{J as default};
